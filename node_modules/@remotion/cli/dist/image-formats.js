"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getVideoImageFormat = void 0;
const renderer_1 = require("@remotion/renderer");
const config_1 = require("./config");
const parse_command_line_1 = require("./parse-command-line");
const getVideoImageFormat = ({ codec, uiImageFormat, }) => {
    if (uiImageFormat !== null) {
        return uiImageFormat;
    }
    if (typeof parse_command_line_1.parsedCli['image-format'] !== 'undefined') {
        if (!renderer_1.RenderInternals.validVideoImageFormats.includes(parse_command_line_1.parsedCli['image-format'])) {
            throw new Error(`Invalid image format: ${parse_command_line_1.parsedCli['image-format']}`);
        }
        return parse_command_line_1.parsedCli['image-format'];
    }
    const configFileOption = config_1.ConfigInternals.getUserPreferredVideoImageFormat();
    if (typeof configFileOption !== 'undefined') {
        return configFileOption;
    }
    if (renderer_1.RenderInternals.isAudioCodec(codec)) {
        return 'none';
    }
    if (codec === 'h264' ||
        codec === 'h264-mkv' ||
        codec === 'h265' ||
        codec === 'vp8' ||
        codec === 'vp9' ||
        codec === 'prores' ||
        codec === 'gif') {
        return 'jpeg';
    }
    if (codec === undefined) {
        return 'png';
    }
    throw new Error('Unrecognized codec ' + codec);
};
exports.getVideoImageFormat = getVideoImageFormat;
